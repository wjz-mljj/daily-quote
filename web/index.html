<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>每日一句 - AI分析</title>
  <link rel="stylesheet" href="/static/css/element-plus.css">
   <style>
    body{
        margin: 0;
        padding: 0;
        width: 100vw;
        height: 100vh;
        overflow: auto;
    }
    .container {
      width: 100vw;
      height: 100vh;
      overflow: auto;
      position: relative;
    }
    .box{
        position: relative;
        left: 50%;
        transform: translateX(-50%);
        width: 600px;
        height: 600px;
        margin-top: 100px;
        text-align: left;
        box-shadow: 0px 12px 32px 4px rgba(0, 0, 0, .04), 0px 8px 20px rgba(0, 0, 0, .08);
        box-sizing: border-box;
        padding: 20px;
        display: flex;
        flex-direction: column;
    }
    .list-box{
        width: 100%;
        border: 1px solid #f1f1f1;
        margin-top: 30px;
        box-sizing: border-box;
        padding: 10px;
        flex: 1;
        overflow-y: auto;
    }
    .single{
        margin-top: 10px;
        font-size: 14px;
        display: flex;
        align-items: baseline;
        cursor: pointer;
    }
    .single:last-child{
        margin-bottom: 10px;
    }
    .textCenter{
        text-align: center;
    }
    .config{
        position: absolute;
        top: -40px;
        right: 20px;
        cursor: pointer;
        width: 30px;
        height: 30px;
    }
   </style>
</head>
<body>
<div id="app">
    <div class="container">
        
        <div class="box">
            <img src="/static/icon/config.png" class="config" @click="configDialogVisible = true" title="配置" />
            <div class="textCenter" style="width: 100%;">
                <el-text class="textCenter" type="primary" size="large">{{ message }}</el-text>
            </div>
            
            <div class="textCenter" style="margin: 20px 0;">
                <el-button type="success" @click="getDailySentence">每日一句</el-button>  
            </div>
            <div style="text-align: center;">
                <el-select v-model="currentModel" placeholder="" style="width: 200px">
                    <el-option
                        v-for="item in options"
                        :key="item.value"
                        :label="item.label"
                        :value="item.value"
                    />
                </el-select>
                <el-select v-model="currentModelAnalysis" placeholder="" style="width: 150px">
                    <el-option
                        v-for="item in optionsAnalysis"
                        :key="item.value"
                        :label="item.label"
                        :value="item.value"
                    />
                </el-select>
                <el-button :loading="loading" @click="getOllamaAnalysis">{{loading ? '分析中' : 'AI分析'}}</el-button>
                
            </div>
            <div class="list-box" v-show="analysisResult" v-html="analysisResult"></div>

            <!-- config -->
             <el-dialog
                v-model="configDialogVisible"
                title="配置"
                width="600"
                append-to-body
                :close-on-click-modal="false"
            >
                <div>
                     <div style="display: flex; align-items: center; margin-bottom: 20px;">
                        <div style="width: 120px;">Ollama本地模型：</div>
                        <el-button type="danger" @click="deleteModelDialogVisible = true">删除</el-button>
                        <el-button type="success" @click="pullModelDialogVisible = true">拉取</el-button>
                    </div>
                    <div style="display: flex; align-items: center; margin-bottom: 20px;">
                        <div style="width: 120px;">数据列表：</div>
                        <!-- <el-button type="danger">导入</el-button> -->
                        <el-button type="primary" @click="dialogVisible = true">添加</el-button>
                        <el-button type="success" @click="exportSentences">导出</el-button>
                    </div>
                    <div>
                        <el-table :data="tableData" style="width: 100%" max-height="300" border>
                            <el-table-column prop="content" label="内容">
                                <template #default="scope">
                                    <div>{{ scope.row.content }}</div>
                                </template>
                            </el-table-column>
                            <el-table-column fixed="right" label="操作" width="100">
                                <template #default="scope">
                                    <el-popconfirm
                                        title="是否删除该句子？"
                                        placement="top-start"
                                        confirm-button-text="确认"
                                        cancel-button-text="取消"
                                        @confirm="handleDelSentence(scope.row)"
                                    >
                                    <template #reference>
                                        <el-button type="danger">删除</el-button>
                                    </template>
                                  </el-popconfirm>
                                    
                                </template>
                            </el-table-column>
                        </el-table>
                        <div style="margin-top: 6px;display: flex;justify-content: end;width: 100%;">
                            <el-pagination layout="prev, pager, next"
                                v-model:current-page="formPagination.page"
                                v-model:page-size="formPagination.pageSize"
                                :total="formPagination.total"
                                @current-change="handlePagination"
                            />
                        </div>
                       
                    </div>
                </div>
            </el-dialog>
            <!-- 删除模型 -->
            <el-dialog
                v-model="deleteModelDialogVisible"
                title="删除模型"
                width="500"
                append-to-body
                :close-on-click-modal="false"
            >
                <div>
                    <el-select v-model="currentModelToDelete" placeholder="请选择要删除的模型">
                        <el-option
                            v-for="item in options"
                            :key="item.value"
                            :label="item.label"
                            :value="item.value"
                        />
                    </el-select>
                </div>
                <template #footer>
                    <div class="dialog-footer">
                      <el-button @click="deleteModelDialogVisible = false">取消</el-button>
                      <el-button type="primary" @click="handleDelModel">确认</el-button>
                    </div>
                  </template>
            </el-dialog>
            <!-- 拉取 -->
            <el-dialog
                v-model="pullModelDialogVisible"
                title="拉取模型"
                width="500"
                append-to-body
                :close-on-click-modal="false"
            >
                <div>
                    <div>
                        <el-input type="text" v-model="pullModelName" :disabled="pullLoading" placeholder="请输入要拉取的模型名称" />
                    </div>
                    <div>
                        {{pullLoading ? '拉取中...' : pullError}}
                    </div>
                </div>
                <template #footer>
                    <div class="dialog-footer">
                      <el-button @click="pullModelDialogVisible = false" :disabled="pullLoading">取消</el-button>
                      <el-button type="primary" @click="handlePullModel" :loading="pullLoading">确认</el-button>
                    </div>
                  </template>
            </el-dialog>
            <!-- 添加 -->
            <el-dialog
                v-model="dialogVisible"
                title="添加"
                width="500"
                append-to-body
                :close-on-click-modal="false"
            >
                <div>
                   <div>
                        <el-input
                            v-model="input"
                            type="textarea"
                            placeholder="请输入"
                            maxlength="50"
                            show-word-limit
                            word-limit-position="outside"
                            :rows="3"
                        />
                   </div>
                </div>
                <template #footer>
                    <div class="dialog-footer">
                      <el-button @click="dialogVisible = false">取消</el-button>
                      <el-button type="primary" @click="handleAdd">确认</el-button>
                    </div>
                  </template>
            </el-dialog>
        
        </div>
    </div>
</div>
<script src="/static/js/vue.js"></script>
<script src="/static/js/element-plus.js"></script>
<script src="/static/js/main.js"></script>
</body>
</html>
